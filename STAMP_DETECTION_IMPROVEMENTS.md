# ‚úÖ –£–ª—É—á—à–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–∞–¥–ø–∏—Å–∏

## –ü—Ä–æ–±–ª–µ–º–∞
–§—É–Ω–∫—Ü–∏—è `detect_stamp_top_edge_landscape` –Ω–µ –∏–º–µ–ª–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö –ª–æ–≥–æ–≤ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–∞–¥–ø–∏—Å–∏ –Ω–∞ landscape —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö.

## –†–µ—à–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–¥—Ä–æ–±–Ω—ã–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏

#### üîç –õ–æ–≥–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∞–Ω–∞–ª–∏–∑–∞:
- **–ù–∞—á–∞–ª–æ –¥–µ—Ç–µ–∫—Ü–∏–∏**: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ –∏ –Ω–æ–º–µ—Ä–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- **–†–∞–∑–º–µ—Ä—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã**: –®–∏—Ä–∏–Ω–∞, –≤—ã—Å–æ—Ç–∞, —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω
- **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: –ú–∞—Å—à—Ç–∞–±, —Ä–∞–∑–º–µ—Ä—ã pixmap
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: –†–∞–∑–º–µ—Ä—ã, –¥–∏–∞–ø–∞–∑–æ–Ω –ø–∏–∫—Å–µ–ª–µ–π
- **–ê–Ω–∞–ª–∏–∑ –æ–±–ª–∞—Å—Ç–∏**: –†–∞–∑–º–µ—Ä—ã –Ω–∏–∂–Ω–µ–π –æ–±–ª–∞—Å—Ç–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ —à—Ç–∞–º–ø–∞

#### üîç –õ–æ–≥–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ –∫—Ä–∞–µ–≤:
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã Canny**: –ù–∏–∂–Ω–∏–π –∏ –≤–µ—Ä—Ö–Ω–∏–π –ø–æ—Ä–æ–≥–∏
- **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–µ—Ç–µ–∫—Ü–∏–∏**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∫—Ä–∞–µ–≤, –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞

#### üîç –õ–æ–≥–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ –∫–æ–Ω—Ç—É—Ä–æ–≤:
- **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç—É—Ä–æ–≤**: –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç—É—Ä—ã
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç—É—Ä–æ–≤**: –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–∂–¥–æ–º –∫–æ–Ω—Ç—É—Ä–µ
- **–í–∞–ª–∏–¥–Ω—ã–µ –∫–æ–Ω—Ç—É—Ä—ã**: –ü–ª–æ—â–∞–¥—å, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–≥–ª–æ–≤

#### üîç –õ–æ–≥–∏ –≤—ã–±–æ—Ä–∞ —à—Ç–∞–º–ø–∞:
- **–ö–∞–Ω–¥–∏–¥–∞—Ç—ã**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –ø–ª–æ—â–∞–¥–∏ –≤—Å–µ—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
- **–í—ã–±—Ä–∞–Ω–Ω—ã–π —à—Ç–∞–º–ø**: –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –ø–ª–æ—â–∞–¥—å, —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω
- **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç**: –ü–æ–¥—Ä–æ–±–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ—Å—á–µ—Ç–∞ –≤ PDF —Ç–æ—á–∫–∏
- **–£—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏**: "high" (–æ–¥–∏–Ω –∫–∞–Ω–¥–∏–¥–∞—Ç) –∏–ª–∏ "medium" (–Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤)

### 2. –£–ª—É—á—à–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–µ—Ç–µ–∫—Ü–∏–∏

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã Canny:
- **–ë—ã–ª–æ**: `cv2.Canny(bottom_region, 50, 150)`
- **–°—Ç–∞–ª–æ**: `cv2.Canny(bottom_region, 30, 100)` - –±–æ–ª–µ–µ –º—è–≥–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

#### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç—É—Ä–æ–≤:
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–ª–æ—â–∞–¥—å**: –£–º–µ–Ω—å—à–µ–Ω–∞ —Å 1000 –¥–æ 100 –ø–∏–∫—Å–µ–ª–µ–π
- **Epsilon –¥–ª—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏**: –£–≤–µ–ª–∏—á–µ–Ω —Å 0.02 –¥–æ 0.05
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–≥–ª–æ–≤**: –†–∞–∑—Ä–µ—à–µ–Ω–æ >= 4 –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–≥–æ 4
- **–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω**: –†–∞—Å—à–∏—Ä–µ–Ω–æ —Å 0.5-3.0 –¥–æ 0.3-5.0

### 3. –£–ª—É—á—à–µ–Ω fallback —Ä–µ–∂–∏–º

#### –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏:
- **–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã**: –£–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ fallback
- **–ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä–∞–Ω–∏—Ü—ã**: –†–∞–∑–º–µ—Ä—ã –∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏ –º–µ—Ç–æ–¥ —Ä–∞—Å—á–µ—Ç–∞
- **–û—à–∏–±–∫–∏**: –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
# –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π landscape PDF —Å –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–∞–¥–ø–∏—Å—å—é
üìÑ –†–∞–∑–º–µ—Ä—ã: 841.89 x 595.28 (landscape)
üéØ –û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–¥–ø–∏—Å—å: x=615.12, y=56.69, w=170.08, h=56.69

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–µ—Ç–µ–∫—Ü–∏–∏:
‚úÖ –ù–∞–π–¥–µ–Ω–æ 9 –≤–∞–ª–∏–¥–Ω—ã—Ö –∫–æ–Ω—Ç—É—Ä–æ–≤
‚úÖ –í—ã–±—Ä–∞–Ω –ª—É—á—à–∏–π –∫–æ–Ω—Ç—É—Ä: –ø–ª–æ—â–∞–¥—å=420, —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ=2.14
‚úÖ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: stamp_top_y_points=82.5
‚úÖ –£—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏: "medium"
```

### ‚úÖ Docker —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
# PDFAnalyzer —É—Å–ø–µ—à–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Docker
‚úÖ OpenCV 4.8.1 —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
‚úÖ Fallback —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ OpenCV
```

### ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏:
```bash
# –ü–æ—Ä—Ç—Ä–µ—Ç–Ω—ã–µ PDF —Ñ–∞–π–ª—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
‚ö†Ô∏è Page is not in landscape orientation - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è None
‚úÖ Fallback –º–µ—Ç–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü
```

## –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- **–≠–º–æ–¥–∑–∏ –≤ –ª–æ–≥–∞—Ö**: –õ–µ–≥–∫–æ —á–∏—Ç–∞–µ–º—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø—Ä–æ—Ü–µ—Å—Å–∞
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: JSON —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**: –ö–∞–∂–¥—ã–π —à–∞–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è

### 2. –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- **–ú—è–≥–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**: –õ—É—á—à–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ —à—Ç–∞–º–ø–æ–≤
- **Fallback —Ä–µ–∂–∏–º**: –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –±–µ–∑ OpenCV
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –ü–æ–¥—Ä–æ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

### 3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Ä–æ–≥–∏**: –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ —Å–∫–æ—Ä–æ—Å—Ç—å—é
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: –ë—ã—Å—Ç—Ä–æ–µ –æ—Ç—Å–µ–∏–≤–∞–Ω–∏–µ –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∫–æ–Ω—Ç—É—Ä–æ–≤

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í–∫–ª—é—á–µ–Ω–∏–µ debug –ª–æ–≥–æ–≤:
```python
import logging
logging.basicConfig(level=logging.DEBUG)

analyzer = PDFAnalyzer()
result = analyzer.detect_stamp_top_edge_landscape("document.pdf", 0)
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
```python
layout_info = analyzer.analyze_page_layout("document.pdf", 0)
print(f"Stamp detected: {layout_info.get('stamp_top_edge')}")
```

## –°—Ç–∞—Ç—É—Å

üéâ **–ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û** - –§—É–Ω–∫—Ü–∏—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–∞–¥–ø–∏—Å–∏ —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏, —É–ª—É—á—à–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–µ—Ç–µ–∫—Ü–∏–∏ –∏ –Ω–∞–¥–µ–∂–Ω—ã–π fallback —Ä–µ–∂–∏–º. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:
- `backend/app/utils/pdf_analyzer.py` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –ª–æ–≥–∞–º–∏
- `docs/PDF_ANALYZER_GUIDE.md` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `DOCKER_OPENCV_FIX.md` - —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º Docker
