# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫

## üêõ **–í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

### 1. **–û—à–∏–±–∫–∞ –≤—ã–∑–æ–≤–∞ –º–µ—Ç–æ–¥–∞ `to_pdf_coords`**
- **–ü—Ä–æ–±–ª–µ–º–∞**: `'PDFAnalyzer' object has no attribute 'to_pdf_coords'`
- **–ü—Ä–∏—á–∏–Ω–∞**: –ú–µ—Ç–æ–¥ –±—ã–ª –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –Ω–∞ `to_pdf_point` –∏ `to_pdf_bbox`, –Ω–æ –≤—ã–∑–æ–≤—ã –Ω–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –≠–≤—Ä–∏—Å—Ç–∏–∫–∏ –ø–∞–¥–∞–ª–∏ —Å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º, –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ Y –≤ PDF-–°–ö

### 2. **–≠–≤—Ä–∏—Å—Ç–∏–∫–∏ "—Ç—è–Ω—É—Ç" QR –≤–≤–µ—Ä—Ö**
- **–ü—Ä–æ–±–ª–µ–º–∞**: –í—ã–±–∏—Ä–∞–µ—Ç—Å—è "—Å–∞–º–∞—è –≤–µ—Ä—Ö–Ω—è—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è" (Y=0)
- **–ü—Ä–∏—á–∏–Ω–∞**: –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ `valid_lines.sort(key=lambda line: line["y"])` + –≤—ã–±–æ—Ä `valid_lines[0]`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: QR –∫–æ–¥ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤–º–µ—Å—Ç–æ –Ω–∏–∂–Ω–µ–π

## ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

### 1. **–û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—ã–∑–æ–≤—ã –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç**

**–ë—ã–ª–æ:**
```python
x_pdf, y_pdf = self.to_pdf_coords(x_img_points, y_img_points, img_height_points, page_height)
```

**–°—Ç–∞–ª–æ:**
```python
x_pdf, y_pdf = self.to_pdf_point(x_img_points, y_img_points, page_height)
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ 5 –º–µ—Å—Ç–∞—Ö:**
- `detect_stamp_top_edge_landscape` - –∫–æ–Ω–≤–µ—Ä—Å–∏—è stamp_top_y
- `detect_right_frame_edge` - –∫–æ–Ω–≤–µ—Ä—Å–∏—è frame_right_x  
- `detect_bottom_frame_edge` - –∫–æ–Ω–≤–µ—Ä—Å–∏—è frame_bottom_y
- `detect_horizontal_line_18cm` - –∫–æ–Ω–≤–µ—Ä—Å–∏—è y –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ª–∏–Ω–∏–∏
- `_find_all_horizontal_lines` - –∫–æ–Ω–≤–µ—Ä—Å–∏—è y –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ª–∏–Ω–∏–π

### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö –ª–∏–Ω–∏–π**

**–ë—ã–ª–æ:**
```python
# –°–æ—Ä—Ç–∏—Ä—É–µ–º –ª–∏–Ω–∏–∏ –ø–æ Y-–ø–æ–∑–∏—Ü–∏–∏ (–æ—Ç –≤–µ—Ä—Ö–∞ –∫ –Ω–∏–∑—É) –∏ –≤—ã–±–∏—Ä–∞–µ–º —Å–∞–º—É—é –≤–µ—Ä—Ö–Ω—é—é
valid_lines.sort(key=lambda line: line["y"])  # –°–æ—Ä—Ç–∏—Ä—É–µ–º –æ—Ç –≤–µ—Ä—Ö–∞ –∫ –Ω–∏–∑—É
best_line = valid_lines[0]  # –°–∞–º–∞—è –≤–µ—Ä—Ö–Ω—è—è –ª–∏–Ω–∏—è
```

**–°—Ç–∞–ª–æ:**
```python
# –°–æ—Ä—Ç–∏—Ä—É–µ–º –ª–∏–Ω–∏–∏ –ø–æ Y-–ø–æ–∑–∏—Ü–∏–∏ (–æ—Ç –Ω–∏–∑–∞ –∫ –≤–µ—Ä—Ö—É) –∏ –≤—ã–±–∏—Ä–∞–µ–º —Å–∞–º—É—é –Ω–∏–∂–Ω—é—é
valid_lines.sort(key=lambda line: line["y"], reverse=True)  # –°–æ—Ä—Ç–∏—Ä—É–µ–º –æ—Ç –Ω–∏–∑–∞ –∫ –≤–µ—Ä—Ö—É
best_line = valid_lines[0]  # –°–∞–º–∞—è –Ω–∏–∂–Ω—è—è –ª–∏–Ω–∏—è (–±–ª–∏–∂–µ –∫ –±–∞–∑–æ–≤–æ–º—É —è–∫–æ—Ä—é)
```

### 3. **–î–æ–±–∞–≤–ª–µ–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–µ–ª—å—Ç—ã —ç–≤—Ä–∏—Å—Ç–∏–∫**

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
```python
# –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–µ–ª—å—Ç—É –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è "–ø–æ–¥–Ω—è—Ç–∏—è" QR –≤ –≤–µ—Ä—Ö
max_delta = 50.0  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–µ–ª—å—Ç–∞ –≤ —Ç–æ—á–∫–∞—Ö
dx = max(-max_delta, min(dx, max_delta))
dy = max(-max_delta, min(dy, max_delta))  # –ù–ï –ø–æ–¥–Ω–∏–º–∞–µ–º –≤ –≤–µ—Ä—Ö!
```

## üéØ **–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
- ‚ùå `'PDFAnalyzer' object has no attribute 'to_pdf_coords'` - –ø–∞–¥–µ–Ω–∏–µ —Å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º
- ‚ùå QR –∫–æ–¥ –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (Y=700+ pt)
- ‚ùå –≠–≤—Ä–∏—Å—Ç–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –∑–∞–º–µ–Ω–∞ —è–∫–æ—Ä—è, –∞ –Ω–µ –∫–∞–∫ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä—ã

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
- ‚úÖ –ö–æ–Ω–≤–µ—Ä—Å–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ QR –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –≤–Ω–∏–∑—É —Å–ø—Ä–∞–≤–∞ (–±–ª–∏–∑–∫–æ –∫ –±–∞–∑–æ–≤–æ–º—É —è–∫–æ—Ä—é)
- ‚úÖ –≠–≤—Ä–∏—Å—Ç–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –º–µ–ª–∫–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä—ã (¬±50 pt –º–∞–∫—Å–∏–º—É–º)
- ‚úÖ –°–æ–±–ª—é–¥–∞–µ—Ç—Å—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ "–Ω–∏–∫–∞–∫–æ–≥–æ –ø–µ—Ä–µ—Å–∫–∞–∫–∏–≤–∞–Ω–∏—è –Ω–∞ –≤–µ—Ä—Ö"

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å:

```bash
# –°–æ–∑–¥–∞—Ç—å —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
python generate_synthetic_tests.py

# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
python test_synthetic_positioning.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–π—Ç–∏ —Å –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ–º ‚â§1 pt –æ—Ç –æ–∂–∏–¥–∞–µ–º—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç.

## üìã **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:**

–í—Å–µ –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:
1. ‚úÖ –ú–µ—Ç–æ–¥—ã –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω—ã
2. ‚úÖ –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö –ª–∏–Ω–∏–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞  
3. ‚úÖ –î–µ–ª—å—Ç–∞ —ç–≤—Ä–∏—Å—Ç–∏–∫ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ–≥–ª–∞—Å–Ω–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É –∑–∞–¥–∞–Ω–∏—é! üöÄ
